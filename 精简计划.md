

# 第5批 - Lambda冗余文件
cd app/controllers/lambda_handlers/
rm -f jsonpatch.py jsonpointer.py mypy_extensions.py six.py typing_extensions.py typing_inspect.py test_import.py
cd -

# 第6批 - 基础设施临时文件
cd infrastructure/
rm -f cdk-outputs.json outputs.json ragapi-outputs.json web-outputs.json cloudfront_url.txt
rm -f app_fixed.py app_v2.py test_import.py CDK_FIX_NOTES.md
rm -rf cdk.out/ venv/
cd -

# 第7批 - 冗余脚本
cd scripts/
rm -f build_lambda_*.sh build_lambda_*.py test_lambda_name.sh
cd -

# 清理根目录的cdk.out
rm -rf cdk.out/
rm -rf lambda_build_temp/
```

#### 方式B: 使用清理脚本
```python
# scripts/cleanup_project.py
import os
import shutil
from pathlib import Path

def cleanup_project():
    """执行项目清理"""
    
    # 定义要删除的文件和目录
    files_to_delete = [
        # 第1批
        "Makefile.backup.*",
        "lambda_backup.json",
        "工作记录.md*",
        "response.json",
        "lambda_env.json", 
        "env_compact.json",
        
        # 第2批
        "test_*.py",
        "improved_scoring.py",
        "verify_*.py",
        "test-api.html",
        
        # 第3批
        "TECH_DEBT_ANALYSIS.md",
        "FIX_SCORE_SOLUTION.md",
        "FINAL_FIX.md",
        "测试报告.md",
        "解决方案报告.md",
        "部署*.md",
    ]
    
    dirs_to_delete = [
        "cdk.out",
        "lambda_build_temp",
        "infrastructure/venv",
        "infrastructure/cdk.out"
    ]
    
    # 执行清理...
    
if __name__ == "__main__":
    cleanup_project()
```

### 3. 验证清理结果
```bash
# 确保核心功能正常
make test

# 检查项目结构
tree -L 2

# 统计文件数量
find . -type f | wc -l
```

## 💾 预期结果
- **文件减少**: ~60% (从150+减少到~60个核心文件)
- **项目大小**: 减少 ~40%
- **结构清晰度**: 大幅提升
- **维护性**: 显著改善

## ⚠️ 重要提醒

### 清理前检查
1. **确认没有未提交的重要更改**
   ```bash
   git status
   ```

2. **创建完整备份**
   ```bash
   tar -czf pre_cleanup_backup.tar.gz .
   ```

3. **记录当前功能状态**
   ```bash
   make test > test_results_before.txt
   ```

### 清理注意事项
- 保留 `.gitignore` 中忽略的必要文件
- 不要删除正在使用的环境配置文件
- 保留 `.env` 文件（如果存在）
- 清理后立即运行测试确保功能正常

### 清理后验证
1. **运行测试套件**
   ```bash
   make test
   ```

2. **验证部署功能**
   ```bash
   make deploy-check
   ```

3. **检查API功能**
   ```bash
   curl -X GET https://your-api-endpoint/health
   ```

## 📈 清理效果评估

### 量化指标
- 文件数量: 150+ → ~60
- 代码行数: 减少冗余代码约30%
- 部署包大小: 减少约40%
- 构建时间: 预计减少20-30%

### 质量改善
- ✅ 项目结构更清晰
- ✅ 减少维护成本
- ✅ 提高开发效率
- ✅ 降低认知负担

## 🔄 后续建议

1. **建立文件管理规范**
   - 测试文件统一放在 `tests/` 目录
   - 临时文件使用 `.tmp` 后缀
   - 备份文件放在独立的 `backups/` 目录

2. **定期清理机制**
   - 每月执行一次清理检查
   - 使用 `.gitignore` 排除临时文件
   - CI/CD 流程中加入清理步骤

3. **文档管理**
   - 归档历史文档到 `docs/archive/`
   - 保持 README 和核心文档更新
   - 删除过时的技术债务文档

---

*生成时间: 2025-08-16*
*项目: AWS-Zilliz-RAG*