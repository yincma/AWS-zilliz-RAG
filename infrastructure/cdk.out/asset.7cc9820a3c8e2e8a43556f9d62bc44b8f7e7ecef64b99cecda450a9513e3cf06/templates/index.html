<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAG智能问答系统</title>
    <link rel="stylesheet" href="/css/style.css">
    <script src="/config.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>🤖 RAG智能问答系统</h1>
            <p>基于AWS Bedrock和Zilliz的检索增强生成系统</p>
        </header>

        <main>
            <!-- 查询区域 -->
            <section class="query-section">
                <div class="input-group">
                    <textarea id="queryInput" 
                              placeholder="请输入您的问题..." 
                              rows="3"></textarea>
                    <button id="queryBtn" class="btn-primary">
                        <span class="btn-text">提问</span>
                        <span class="loader" style="display: none;"></span>
                    </button>
                </div>
                
                <div class="options">
                    <label>
                        返回文档数量：
                        <select id="topK">
                            <option value="3">3</option>
                            <option value="5" selected>5</option>
                            <option value="10">10</option>
                        </select>
                    </label>
                </div>
            </section>

            <!-- 答案显示区域 -->
            <section class="answer-section" id="answerSection" style="display: none;">
                <h2>回答</h2>
                <div class="answer-content" id="answerContent"></div>
                
                <div class="confidence" id="confidenceBar" style="display: none;">
                    <span>置信度：</span>
                    <div class="confidence-bar">
                        <div class="confidence-fill" id="confidenceFill"></div>
                    </div>
                    <span id="confidenceValue">0%</span>
                </div>
            </section>

            <!-- 来源文档显示 -->
            <section class="sources-section" id="sourcesSection" style="display: none;">
                <h2>参考来源</h2>
                <div class="sources-list" id="sourcesList"></div>
            </section>

            <!-- 文档管理 -->
            <section class="document-section">
                <h2>文档管理</h2>
                <div class="tab-container">
                    <div class="tabs">
                        <button class="tab active" data-tab="upload">上传文档</button>
                        <button class="tab" data-tab="s3">S3文档</button>
                        <button class="tab" data-tab="stats">系统状态</button>
                    </div>
                    
                    <!-- 上传文档 -->
                    <div class="tab-content active" id="upload">
                        <div class="upload-area" id="uploadArea">
                            <input type="file" id="fileInput" 
                                   accept=".pdf,.txt,.md" 
                                   multiple style="display: none;">
                            <p>📁 拖拽文件到这里或点击选择</p>
                            <p class="hint">支持PDF、TXT、Markdown格式</p>
                        </div>
                        <div class="file-list" id="fileList"></div>
                        <button id="uploadBtn" class="btn-secondary" style="display: none;">
                            开始上传
                        </button>
                    </div>
                    
                    <!-- S3文档 -->
                    <div class="tab-content" id="s3">
                        <div class="s3-input">
                            <input type="text" id="s3Key" 
                                   placeholder="输入S3对象键（如：documents/sample.pdf）">
                            <button id="s3IngestBtn" class="btn-secondary">
                                摄入文档
                            </button>
                        </div>
                        <div class="s3-batch">
                            <textarea id="s3Keys" 
                                     placeholder="批量输入S3对象键，每行一个" 
                                     rows="5"></textarea>
                            <button id="s3BatchIngestBtn" class="btn-secondary">
                                批量摄入
                            </button>
                        </div>
                    </div>
                    
                    <!-- 系统状态 -->
                    <div class="tab-content" id="stats">
                        <div class="stats-container" id="statsContainer">
                            <p>加载中...</p>
                        </div>
                        <button id="refreshStatsBtn" class="btn-secondary">
                            刷新状态
                        </button>
                        <button id="clearKBBtn" class="btn-danger">
                            清空知识库
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <footer>
            <p>Powered by AWS Bedrock Nova & Zilliz Cloud</p>
        </footer>
    </div>

    <!-- 消息提示 -->
    <div class="toast" id="toast"></div>

    <script src="/js/main.js"></script>
</body>
</html>